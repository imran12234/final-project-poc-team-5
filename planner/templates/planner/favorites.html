{% extends "planner/base.html" %}
{% load static %}
{% block title %}Favorited Itineraries{% endblock %}

{% block content %}


<div class="container py-5">

  <h2 class="display-5 fw-semibold mb-4">Your Favorited Itineraries</h2>

  <div class="itinerary-list-container">
    {% if user.is_authenticated %}
      {% if favorites %}
        <div class="list-group">
          {% for fav_itinerary in favorites %}
          <a href="{% url 'planner:summary' %}?itinerary_id={{ fav_itinerary.id }}" class="list-group-item list-group-item-action mb-3 shadow-sm itinerary-card">
            <div class="row g-0">
                <div class="col-md-3 col-sm-4 d-flex align-items-center justify-content-center itinerary-image-container">
                  {% with fav_itinerary.ordered_activities.0 as activity %}
                    {% if activity and activity.photo_name %}
                      <img src="{{ activity.photo_name }}" class="img-fluid rounded" alt="Image for {{ activity.activity_name }}" style="object-fit: cover; width: 100%; height: 150px;">
                    {% else %}
                      <img src="{% static 'images/placeholder-itinerary.png' %}" class="img-fluid rounded-start" alt="Itinerary: {{ fav_itinerary.name }}" style="object-fit: cover; width: 100%; height: 150px;">
                    {% endif %}
                  {% endwith %}
                </div>
                <div class="col-md-9 col-sm-8 ps-3">
                  <div class="card-body">
                    <h5 class="card-title">{{ fav_itinerary.name }}</h5>
                    <p class="card-text"><small class="text-muted">
                      A wonderful trip to explore Chicago. Includes various activities and sights. Click to view the full day-by-day plan.
                    </small></p>
                    <p class="card-text"><strong>Duration:</strong> {{ fav_itinerary.total_duration }} day{% if fav_itinerary.total_duration != 1 %}s{% endif %}</p>
                  </div>
                </div>
              </div>
            </a>
          {% endfor %}
        </div>
        {% else %}
        <div class="text-center p-4 p-md-5 border rounded shadow-sm" style="background-color: #ffffff; max-width: 700px; margin: 2rem auto;">
          <p style="font-size: 1.6rem; font-weight: 500; color: #343a40; margin-bottom: 0.75rem;">You have no favorited itineraries yet.</p>
          <p style="font-size: 1.05rem; color: #6c757d; margin-bottom: 2rem;">Start planning your next adventure and save your itineraries here!</p>
          <a href="{% url 'planner:survey' %}" class="btn btn-lg" style="background-color: #28a745; border-color: #28a745; color: white; padding: 0.6rem 1.75rem; font-size: 1.05rem; font-weight: 500;">Create New Itinerary</a>
        </div>
      {% endif %}
    {% else %}

      <div class="text-center p-4 p-md-5 border rounded shadow-sm" style="background-color: #ffffff; max-width: 700px; margin: 2rem auto;">
        <i class="fas fa-map-signs fa-3x text-muted mb-4"></i>
        <p style="font-size: 1.6rem; font-weight: 500; color: #343a40; margin-bottom: 0.75rem;">Login to favorite your itineraries.</p>
        <p style="font-size: 1.05rem; color: #6c757d; margin-bottom: 2rem;">Save your itineraries and they will appear here!</p>
        <div>
          <a href="{% url 'planner:login' %}" class="btn btn-primary btn-lg mt-2" style="padding: 0.6rem 1.75rem; font-size: 1.05rem; font-weight: 500;">Login</a>
          <a href="{% url 'planner:register' %}" class="btn btn-secondary btn-lg mt-2 ms-sm-2" style="padding: 0.6rem 1.75rem; font-size: 1.05rem; font-weight: 500;">Register</a>
        </div>
      </div>
    {% endif %}
  </div>
</div>

<style>
.itinerary-list-container {
max-height: 70vh; 
overflow-y: auto;
padding-right: 10px; 
}

.itinerary-list-container::-webkit-scrollbar {
width: 8px;
}
.itinerary-list-container::-webkit-scrollbar-track {
background: #f1f1f1;
border-radius: 10px;
}
.itinerary-list-container::-webkit-scrollbar-thumb {
background: #888;
border-radius: 10px;
}
.itinerary-list-container::-webkit-scrollbar-thumb:hover {
background: #555;
}

.itinerary-card {
transition: box-shadow .2s ease-in-out, transform .2s ease-in-out;
background-color: #fff; 
}

.itinerary-card:hover {
box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important;
transform: translateY(-2px);
}

.itinerary-image-container img, 
.itinerary-image-container svg {
border-top-left-radius: .375rem;
border-bottom-left-radius: .375rem;
}


@media (max-width: 575.98px) { 
.itinerary-card .row > div { 
  flex-basis: 100%; 
  max-width: 100%;
}
.itinerary-image-container img, 
.itinerary-image-container svg {
  height: 180px; 
  border-bottom-left-radius: 0; 
  border-top-right-radius: .375rem; 
}
.itinerary-card .card-body {
    padding-top: 0.5rem; 
}
}

.list-group-item.list-group-item-action {
color: #333; 
text-decoration: none; 
}

.list-group-item.list-group-item-action:hover,
.list-group-item.list-group-item-action:focus {
background-color: #f8f9fa;
}
</style>
          

{% endblock %}
